\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set your working directory

# Load your packages
#install.packages('readxl')
library(readxl)
library(here)
library(tidyverse)
library(lubridate)

# Set your ggplot theme

# Load your datasets

#Importing electricity generation datasets in bulk
eia923GenerationFiles = list.files(path = "./Data/Raw/eia923/", pattern=".xlsx", full.names=TRUE)

#Range of file paths for data from Year 2001 to 2010 that require top 6 rows to be skipped
eia923GenerationFiles[1:10]

#Range of file paths for data from Year 2011 to 2022 that require top 5 rows to be skipped
eia923GenerationFiles[11:22]

#Reading and combining files in one dataframe using ldply function
generation_2001to2010_raw <- plyr::ldply(eia923GenerationFiles[1:10],read_excel,skip = 6)

#Storing column names to use the same descriptors for subsequent years
column_names <- colnames(generation_2001to2010_raw)
generation_2011to2022_raw <- plyr::ldply(eia923GenerationFiles[11:22],read_excel,skip = 6, col_names = column_names)

#Wrangling 2001 to 2010 generation data
generation_2001to2010_processed <- generation_2001to2010_raw %>% 
  select(`Plant ID`,`Plant Name`, State,`Census Region`,`NERC Region`,`Reported Fuel Type Code`,`NET GENERATION (megawatthours)`,Year) %>% 
  na.omit() %>% 
  rename('PCODE' = `Plant ID`, 'PNAME' = `Plant Name`, 'CENSUS' = `Census Region`, 'NERC' = `NERC Region`, 'FUEL' = `Reported Fuel Type Code`, 'GENERATION' = `NET GENERATION (megawatthours)`) %>%
  filter(FUEL %in% c('SUN', 'WND', 'GEO')) %>% 
  group_by(State) %>%
  summarise(GENERATION = sum(GENERATION))

#Writing out output as .csv file
write.csv(generation_2001to2010_processed, row.names = FALSE, file = here("Data/Processed/generation_2001to2010_processed.csv"))

#Wrangling 2011 to 2022 generation data
generation_2011to2022_processed <- generation_2011to2022_raw %>% 
  select(`Plant ID`,`Plant Name`, State,`Census Region`,`NERC Region`,`Reported Fuel Type Code`,`NET GENERATION (megawatthours)`,Year) %>% 
  na.omit() %>% 
  rename('PCODE' = `Plant ID`, 'PNAME' = `Plant Name`, 'CENSUS' = `Census Region`, 'NERC' = `NERC Region`, 'FUEL' = `Reported Fuel Type Code`, 'GENERATION' = `NET GENERATION (megawatthours)`) %>%
  filter(FUEL %in% c('SUN', 'WND', 'GEO')) %>% 
  group_by(State) %>%
  summarise(GENERATION = sum(GENERATION))

#Writing out output as .csv file
write.csv(generation_2011to2022_processed, row.names = FALSE, file = here("Data/Processed/generation_2011to2022_processed.csv"))



```


# Rationale and Research Questions



\newpage

# Dataset Information



\newpage

# Exploratory Analysis 



\newpage

# Analysis



## Question 1: <insert specific question here and add additional subsections for additional questions below, if needed>

## Question 2: 




\newpage

# Summary and Conclusions


\newpage

# References
<add references here if relevant, otherwise delete this section> 
