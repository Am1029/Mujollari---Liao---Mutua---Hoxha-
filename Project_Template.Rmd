\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r Setup, include=FALSE}
# Set your working directory

# Load your packages
#install.packages('readxl')
#install.packages('foreign')
#install.packages('sf')
#install.packages('leaflet')
#install.packages('mapview')
library(readxl)
library(here)
library(tidyverse)
library(lubridate)
library(foreign)
library(dplyr)
library(tidyverse, quietly = TRUE)
library(sf)
library(leaflet)
library(mapview); mapviewOptions(fgb = FALSE)

# Set your ggplot theme
theme_set(theme_minimal())

# Check working directory
here()

# Load your datasets
#Importing processed energy monthly generation data
df_generation_monthly <- read.csv(here("Data/Processed/df_generation_monthly.csv"),
                                  stringsAsFactors = TRUE)
#Importing processed pollutant monthly data 
df_pollutant_monthly <- read.csv(here("Data/Processed/df_pollutant.csv"),
                                  stringsAsFactors = TRUE)

#Importing processed plant location and capacity data
df_plantcapacities_locations <- read.csv(here("Data/Processed/df_plantcapacities_locations.csv"),
                                  stringsAsFactors = TRUE)
#Importing processed pollutant observation stations data
df_station_locations <- read.csv(here("Data/Processed/df_latitude_longitude.csv"),
                                  stringsAsFactors = TRUE)
#Importing state abbreviations 
df_state<- read.csv(here("Data/Processed/df_statename.csv"),
                                  stringsAsFactors = TRUE)

#Setting date columns as date objects
df_generation_monthly$Date <- ymd(df_generation_monthly$Date)
df_pollutant_monthly$Date <- ym(df_pollutant_monthly$Date)

#Setting date columns as date objects
df_generation_monthly$Date <- ymd(df_generation_monthly$Date)
df_pollutant_monthly$Date <- ymd(df_pollutant_monthly$Date)

```


# Rationale and Research Questions



\newpage

# Dataset Information



\newpage

# Exploratory Analysis 
```{r Visualization: Generation}
top_states_renewables2022 <- df_generation_monthly %>% 
  filter(Year == 2022) %>% 
  group_by(State) %>% 
  summarise(NetGeneration = sum(NetGeneration)) %>% 
  mutate(Rank = rank(-NetGeneration)) %>% 
  filter(Rank %in% c(1:10))

#visualizing renewable energy generation over time

#Summarizing monthly data into annual data
df_generation_annual <- df_generation_monthly %>% 
  group_by(Year) %>% 
  summarise(NetGeneration = sum(NetGeneration))

#Plotting out trend for top 10 states
plot.MonthlyGeneration <- df_generation_monthly %>%
  filter(State %in% top_states_renewables2022$State) %>% 
  ggplot(aes(x=Date,
             y=NetGeneration,
             color=State)) +
  geom_line() +
  labs(x="Date",
       y="Monthly Energy Generation (MWh)",
       title="Monthly Renewable Energy Generation per State (MWh)")

print(plot.MonthlyGeneration)

plot.AnnualGeneration <- df_generation_annual %>% 
  ggplot(aes(x=Year,
             y=NetGeneration)) +
  geom_line() +
  labs(x="Year",
       y="Annual Energy Generation (MWh)",
       title="Annual Renewable Energy Generation over time (MWh)")

print(plot.AnnualGeneration)
```

```{r Visualization: Pollutant CO}
# Observe air quality variation among the top 10 states in renewable energy generation
top_states_renewables2022$State
unique(df_pollutant_monthly$State)

df_pollutant_location<-merge(df_pollutant_monthly,df_state,by='State') #add state abbreviation

df_pollutant_top10<-df_pollutant_location %>%
  filter(Abbreviation %in% top_states_renewables2022$State) %>%
  arrange(Date)

#confirm the selection is correct 
top_states_renewables2022$State
unique(df_pollutant_top10$Abbreviation)

unique(df_pollutant_top10$Pollutant)
#CO
df_CO_top10<-df_pollutant_top10 %>%
  filter(Pollutant=="Carbon monoxide")

#PM2.5
df_PM2.5_top10<-df_pollutant_top10 %>%
  filter(Pollutant=="PM2.5 - Local Conditions")

#SO2
df_SO2_top10<-df_pollutant_top10 %>%
  filter(Pollutant=="Sulfur dioxide")

#NO2
df_NO2_top10<-df_pollutant_top10 %>%
  filter(Pollutant=="Nitrogen dioxide (NO2)")

#PM10
df_PM10_top10<-df_pollutant_top10 %>%
  filter(Pollutant=="PM10 Total 0-10um STP")

ggplot(df_PM10_top10, aes(x =Date, y = Mean, color=State)) +
  geom_line()+
  labs(x="Date",y="")+
  ggtitle("PM2.5")
ggplot(df_PM2.5_top10, aes(x =Date, y = Mean, color=State)) +
  geom_line()

```
```{r Time Series, message=FALSE}
PM

```

```{r}

counties_sf<- st_read(here('Data/Spatial/cb_2018_us_county_20m.shp'))

colnames(counties_sf)

#
st_crs(counties_sf) 


#
nrow(counties_sf)

#Reveal the extent of this dataset via the st_bbox() function
st_bbox(counties_sf)

#View the data
head(counties_sf)

mapView(counties_sf, zcol = "AWATER")


```


\newpage

# Analysis



## Question 1: <insert specific question here and add additional subsections for additional questions below, if needed>

## Question 2: 




\newpage

# Summary and Conclusions


\newpage

# References
<add references here if relevant, otherwise delete this section> 
